package com.xagitarlabs.crap4j.external;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import com.agitar.org.objectweb.asm.tree.analysis.AnalyzerException;

import com.xagitarlabs.crap4j.ComplexityReader;
import com.xagitarlabs.crap4j.CrapProject;
import com.xagitarlabs.crap4j.MethodComplexity;
import com.xagitarlabs.crap4j.complexity.CyclomaticComplexity;
import com.xagitarlabs.crap4j.util.FileUtil;

/**
 * This class will read the complexity numbers that were generated by the 
 * ant script which was launched by the runner. 
 * 
 * @author bobevans
 *
 */
public class MetricsComplexityReader implements ComplexityReader {

	CrapProject project;

	public MetricsComplexityReader(CrapProject p) {
		this.project = p;		
	}

	public List<MethodComplexity> readMethodComplexities() throws IOException, AnalyzerException{
		List<MethodComplexity> list = new ArrayList<MethodComplexity>();
		List<File> allClassesToMeasure = FileUtil.removeTestClassFiles(project.getAllProjectClasses());
		CyclomaticComplexity cc = new CyclomaticComplexity();
		for (File className : allClassesToMeasure) {
			list.addAll(cc.getMethodComplexitiesFor(className));
		}
		return list;
	}

}
